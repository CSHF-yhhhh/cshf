<!doctype html><html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta><title>计算机网络——网络层 - CSHF</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="CSHF"><meta name="msapplication-TileImage" content="/img/logo.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="CSHF"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="计算机网络——网络层"><meta property="og:type" content="blog"><meta property="og:title" content="计算机网络——网络层"><meta property="og:url" content="https://blog.cshf.xyz/network-network5/"><meta property="og:site_name" content="CSHF"><meta property="og:description" content="计算机网络——网络层"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/ipstruct.jpg"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/iphead.jpg"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/ipadd.png"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/luyoujuhe.png"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/icmpstruct.jpg"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/icmperror.jpg"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/ipv6.jpg"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/ipv6.jpg"><meta property="og:image" content="https://blog.cshf.xyz/network-network5/ipv6addr.jpg"><meta property="article:published_time" content="2021-07-20T08:36:33.000Z"><meta property="article:modified_time" content="2021-08-17T11:39:54.711Z"><meta property="article:author" content="CSHF"><meta property="article:tag" content="NetWork"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/network-network5/ipstruct.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.cshf.xyz/network-network5/"},"headline":"CSHF","image":["https://blog.cshf.xyz/network-network5/ipstruct.jpg","https://blog.cshf.xyz/network-network5/iphead.jpg","https://blog.cshf.xyz/network-network5/ipadd.png","https://blog.cshf.xyz/network-network5/luyoujuhe.png","https://blog.cshf.xyz/network-network5/icmpstruct.jpg","https://blog.cshf.xyz/network-network5/icmperror.jpg","https://blog.cshf.xyz/network-network5/ipv6.jpg","https://blog.cshf.xyz/network-network5/ipv6.jpg","https://blog.cshf.xyz/network-network5/ipv6addr.jpg"],"datePublished":"2021-07-20T08:36:33.000Z","dateModified":"2021-08-17T11:39:54.711Z","author":{"@type":"Person","name":"CSHF"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject"}},"description":"计算机网络——网络层"}</script><link rel="canonical" href="https://blog.cshf.xyz/network-network5/"><link rel="icon" href="/img/logo.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="//hm.baidu.com/hm.js?f72d939143c49eed016fe7d2b8d84b57";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/CSHF_LOGO.png" alt="CSHF" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/CSHF-yhhhh"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time datetime="2021-07-20T08:36:33.000Z" title="2021/7/20 下午4:36:33">2021-07-20</time>发表</span><span class="level-item"><time datetime="2021-08-17T11:39:54.711Z" title="2021/8/17 下午7:39:54">2021-08-17</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/Note/">Note</a><span> / </span><a class="link-muted" href="/categories/Note/NetWork/">NetWork</a></span><span class="level-item">33 分钟读完 (大约4935个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">计算机网络——网络层</h1><div class="content"><p>计算机网络——网络层</p><span id="more"></span><hr><h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ol><li><a href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E6%A6%82%E8%BF%B0">网络层概述</a><ol><li><a href="#%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E5%8D%8F%E8%AE%AE">网络层的协议</a></li><li><a href="#%E5%8A%9F%E8%83%BD">功能</a></li></ol></li><li><a href="#IP%E5%8D%8F%E8%AE%AE">IP 协议</a><ol><li><a href="#IP%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F">IP 数据报格式</a><ol><li><a href="#%E7%BB%84%E6%88%90%E6%A0%BC%E5%BC%8F">组成格式</a></li><li><a href="#IP%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F">IP 首部格式</a></li></ol></li><li><a href="#%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%88%86%E7%89%87">数据报分片</a><ol><li><a href="#%E5%81%8F%E7%A7%BB%E9%87%8F%E7%9A%84%E8%AE%A1%E7%AE%97">偏移量的计算</a></li></ol></li></ol></li><li><a href="#IPv">IPv</a><ol><li><a href="#%E5%88%86%E7%B1%BBIP%E5%9C%B0%E5%9D%80">分类 IP 地址</a><ol><li><a href="#A%E7%B1%BB%E5%9C%B0%E5%9D%80">A 类地址</a></li><li><a href="#B%E7%B1%BB%E5%9C%B0%E5%9D%80">B 类地址</a></li><li><a href="#C%E7%B1%BB%E5%9C%B0%E5%9D%80">C 类地址</a></li><li><a href="#D%E7%B1%BB%E5%9C%B0%E5%9D%80">D 类地址</a></li><li><a href="#E%E7%B1%BB%E5%9C%B0%E5%9D%80:">E 类地址:</a></li><li><a href="#%E7%89%B9%E6%AE%8AIP%E5%9C%B0%E5%9D%80">特殊 IP 地址</a></li><li><a href="#%E6%80%BB%E7%BB%93%E5%AF%B9%E6%AF%94">总结对比</a></li></ol></li></ol></li><li><a href="#%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT">网络地址转换 NAT</a></li><li><a href="#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86,%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81,CIDR">子网划分,子网掩码,CIDR</a><ol><li><a href="#%E5%AD%90%E7%BD%91%E5%88%92%E5%88%86">子网划分</a></li><li><a href="#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81">子网掩码</a><ol><li><a href="#%E8%B7%AF%E7%94%B1%E5%99%A8%E5%88%86%E7%BB%84%E8%BD%AC%E5%8F%91%E7%AE%97%E6%B3%95">路由器分组转发算法</a></li></ol></li><li><a href="#%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80CIDR">无分类编址 CIDR</a><ol><li><a href="#%E8%B7%AF%E7%94%B1%E8%81%9A%E5%90%88">路由聚合</a></li><li><a href="#%E6%9C%80%E9%95%BF%E5%89%8D%E7%BC%80%E5%8C%B9%E9%85%8D">最长前缀匹配</a></li></ol></li></ol></li><li><a href="#ARP%E5%8D%8F%E8%AE%AE">ARP 协议</a><ol><li><a href="#ARP%E5%8D%8F%E8%AE%AE%E5%8E%9F%E7%90%86">ARP 协议原理</a></li><li><a href="#ARP%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5">ARP 使用情况</a></li></ol></li><li><a href="#DHCP%E5%8D%8F%E8%AE%AE">DHCP 协议</a><ol><li><a href="#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B">工作流程</a></li></ol></li><li><a href="#ICMP%E5%8D%8F%E8%AE%AE">ICMP 协议</a><ol><li><a href="#ICMP%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F">ICMP 报文格式</a></li><li><a href="#ICMP%E6%8A%A5%E6%96%87%E7%B1%BB%E5%9E%8B">ICMP 报文类型</a><ol><li><a href="#ICMP%E5%B7%AE%E9%94%99%E6%8A%A5%E5%91%8A%E6%8A%A5%E6%96%87">ICMP 差错报告报文</a></li><li><a href="#ICMP%E8%AF%A2%E9%97%AE%E6%8A%A5%E6%96%87">ICMP 询问报文</a></li></ol></li><li><a href="#ICMP%E7%9A%84%E5%BA%94%E7%94%A8">ICMP 的应用</a></li></ol></li><li><a href="#IPv">IPv</a><ol><li><a href="#IPv%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%A0%BC%E5%BC%8F">IPv 数据报格式</a></li><li><a href="#%E5%AF%B9%E6%AF%94IPv">对比 IPv</a></li><li><a href="#IPv%E5%9C%B0%E5%9D%80%E5%BD%A2%E5%BC%8F">IPv 地址形式</a></li><li><a href="#%E5%9F%BA%E6%9C%AC%E5%9C%B0%E5%9D%80%E7%B1%BB%E5%9E%8B">基本地址类型</a></li><li><a href="#IPv%E4%B8%8EIpv%E7%9A%84%E5%85%BC%E5%AE%B9">IPv 与 Ipv 的兼容</a></li></ol></li></ol><hr><p><span id="网络层概述"></span></p><h1 id="网络层概述"><a href="#网络层概述" class="headerlink" title="网络层概述"></a>网络层概述</h1><p>主要任务是把分组从源端传到目的端, 为分组交换网络上的不同主机提供通信服务<br>网络层的传输单位是数据报</p><blockquote><p>分组是数据报的一个片段</p></blockquote><p><span id="网络层的协议"></span></p><h2 id="网络层的协议"><a href="#网络层的协议" class="headerlink" title="网络层的协议"></a>网络层的协议</h2><ol><li>ARP 协议</li><li>IP 协议</li><li>ICMP 协议</li><li>IGMP 协议</li></ol><blockquote><p>ARP 为 IP 服务<br>IP 为 ICMP 和 IGMP 服务</p></blockquote><p><span id="功能"></span></p><h2 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h2><ol><li>路由选择与分组转发<br>选择最佳路径</li><li>异构网络互联<br>不同网络(局域网,校园网等)的互联</li><li>拥塞控制<br>若所有结点来不及接收分组, 而要丢弃大量分组, 网络就处于拥塞状态<br>通过以下方法来解决这种问题<ul><li>开环控制(静态的方法)<br><strong>静态</strong>的配置,在网络开始工作前, 预先控制所有能产生拥塞的因素</li><li>闭环控制(动态的方法)<br>网络运行时, <strong>动态</strong>的调整来进行拥塞控制</li></ul></li></ol><p><span id="IP协议"></span></p><h1 id="IP-协议"><a href="#IP-协议" class="headerlink" title="IP 协议"></a>IP 协议</h1><p><span id="IP数据报格式"></span></p><h2 id="IP-数据报格式"><a href="#IP-数据报格式" class="headerlink" title="IP 数据报格式"></a>IP 数据报格式</h2><p><span id="组成格式"></span></p><h3 id="组成格式"><a href="#组成格式" class="headerlink" title="组成格式"></a>组成格式</h3><div align="center"><p><img src="/network-network5/ipstruct.jpg" alt="IP数据报格式"></p></div><ul><li>固定部分<br><code>20</code>字节</li><li>可变部分<br>可有可无</li></ul><blockquote><p>IP 数据报过长时, 会分段</p></blockquote><p><span id="IP首部格式"></span></p><h3 id="IP-首部格式"><a href="#IP-首部格式" class="headerlink" title="IP 首部格式"></a>IP 首部格式</h3><div align="center"><p><img src="/network-network5/iphead.jpg" alt="IP数据报首部格式"></p></div><ol><li><p>版本(4 位)<br>IPv4 或 IPv6</p></li><li><p>首部长度(4 位)<br>单位是 <code>4B</code>, 最小为 5</p><blockquote><p>即首部 4 位全为 1, 表示首部长度为$15\times 4B$<br>当首部的长度不是 4B 的倍数时, 会进行填充</p></blockquote></li><li><p>区分服务(8 位)<br>指示希望获得哪种类型的服务</p></li><li><p>总长度(16 位)<br>首部+数据部分的长度, 单位为 <code>1B</code></p></li><li><p>标识(16 位)<br>同一数据报的分片使用相同的标识</p></li><li><p>标志(3 位)<br>只有 2 位有意义,最高位保留<br>中间位 DF=<code>1</code>时, 禁止分片; 中间位 DF=<code>0</code>时, 允许分片<br>最低为 MF=<code>1</code>时, 表示后面还有分片(该分组不是最后一个);<br>最低为 MF=<code>0</code>时, 表示该分组是最后一个或没有分片</p></li><li><p>片偏移(13 位)<br>指出较长分组分片后, 某片在原分组中的相对位置<br>单位为 <code>8B</code></p><blockquote><p>除了最后一个分片, 每个分片的长度一定是 8B 的整数倍</p></blockquote></li><li><p>生存时间 TTL(8 位)<br>IP 分组的保质期(可以经过多少个路由器)<br>每经过一个路由器, 该字段减 1, 该字段为 0 ,则丢弃</p></li><li><p>协议(8 位)<br>数据部分使用的协议</p><blockquote><p><u>1-&gt;ICMP|6-&gt;TCP|17-&gt;UDP</u><br>2-&gt;IGMP|8-&gt;EGP|9-&gt;IGP|41-&gt;IPv6|50-&gt;ESP|89-&gt;OSPF</p></blockquote></li><li><p>首部检验和(16 位)<br>只检验首部</p></li><li><p>源地址(32 位)<br>源 IP 地址</p></li><li><p>目的地址(32 位)<br>目的 IP 地址</p></li><li><p>可选字段<br>范围是 <code>0~40B</code><br>用来支持排错, 测量以及安全等措施</p></li></ol><p><span id="数据报分片"></span></p><h2 id="数据报分片"><a href="#数据报分片" class="headerlink" title="数据报分片"></a>数据报分片</h2><p>是将数据部分进行分片</p><ul><li><p>最大传输单元 MTU</p><p>链路层数据帧可封装数据的上限(数据链路层的数据帧中数据部分的最大长度)</p><blockquote><p>以太网的 MTU 是 1500 字节</p></blockquote><blockquote><p>这里注意<strong>MTU 要包含首部</strong></p></blockquote></li></ul><p><span id="偏移量的计算"></span></p><h3 id="偏移量的计算"><a href="#偏移量的计算" class="headerlink" title="偏移量的计算"></a>偏移量的计算</h3><ol><li>第一个分片的片偏移是<code>0</code></li><li>之后的分片的<br>$$片偏移=\frac{前一个分片的长度+前一个分片的片偏移\times 8}{8}$$</li></ol><p><span id="IPv"></span></p><h1 id="IPv4"><a href="#IPv4" class="headerlink" title="IPv4"></a>IPv4</h1><p>IP 地址: 全世界唯一的 32 位标识符, 标识路由器和主机的接口</p><p><span id="分类IP地址"></span></p><h2 id="分类-IP-地址"><a href="#分类-IP-地址" class="headerlink" title="分类 IP 地址"></a>分类 IP 地址</h2><p><span id="A类地址"></span></p><h3 id="A-类地址"><a href="#A-类地址" class="headerlink" title="A 类地址"></a>A 类地址</h3><p>0(网络号 0 开头)</p><ul><li>net-id(网络号)(8 位)</li><li>host-id(主机号)(24 位)</li><li>地址范围<br>0.0.0.0 ~ 127.255.255.255<br>可用与分配的 IP 地址<br>1.x.y.z ~ 126.x.y.z<br>其中 x,y,z 的各个二进制位不能全为 0 或 1</li><li>私有地址范围<br>10.0.0.0~10.255.255.255(1 个网段)</li></ul><p><span id="B类地址"></span></p><h3 id="B-类地址"><a href="#B-类地址" class="headerlink" title="B 类地址"></a>B 类地址</h3><p>10(网络号 10 开头)</p><ul><li>net-id(网络号)(16 位)</li><li>host-id(主机号)(16 位)</li><li>地址范围<br>128.0.0.0 ~ 191.255.255.255<br>可用与分配的 IP 地址<br>128.0.y.z ~ 191.255.y.z<br>其中 x,y,z 的各个二进制位不能全为 0 或 1</li><li>私有地址范围<br>172.16.0.0~172.31.255.255(16 个网段)</li></ul><p><span id="C类地址"></span></p><h3 id="C-类地址"><a href="#C-类地址" class="headerlink" title="C 类地址"></a>C 类地址</h3><p>110(网络号 110 开头)</p><ul><li>net-id(网络号)(24 位)</li><li>host-id(主机号)(8 位)</li><li>地址范围<br>192.0.0.0 ~ 223.255.255.255<br>可用与分配的 IP 地址<br>192.0.0.z ~ 126.255.255.z<br>其中,z 的各个二进制位不能全为 0 或 1</li><li>私有地址范围<br>192.168.0.0~192.168.255.255(256 个网段)</li></ul><p><span id="D类地址"></span></p><h3 id="D-类地址"><a href="#D-类地址" class="headerlink" title="D 类地址"></a>D 类地址</h3><p>1110(网络号 1110 开头), 属于多播地址</p><ul><li>直接广播地址<br>A,B,C 类 IP 地址中主机号全为 1 的地址,用来使路由器将一个分组以广播的方式发送给特定网络上的所有主机</li><li>受限广播地址<br>网络号与主机号全为 1 的地址<br>用来将一个分组以广播方式发送给本网所有主机(路由器则阻挡该分组通过)</li><li>组播地址<br>范围 224.0.0.0 ~ 239.255.255.255 范围内的每个 IP 地址(实际上代表一组特定的主机)</li><li>广播地址与组播地址<ul><li>相同点:只能作为 IP 报文的目的地址，表示该报文的一组接收者，而不能把它分配给某台具体的主机。</li><li>区别:广播地址是按主机的物理位置来划分各组的(属于同一个子网)；组播地址指定一个逻辑组，参与该组的机器未必在同一个网内，可能遍布整个 Internet 网。</li></ul></li></ul><p><span id="E类地址:"></span></p><h3 id="E-类地址"><a href="#E-类地址" class="headerlink" title="E 类地址:"></a>E 类地址:</h3><p>1111(网络号 1111 开头)<br>保留为今后使用</p><p><span id="特殊IP地址"></span></p><h3 id="特殊-IP-地址"><a href="#特殊-IP-地址" class="headerlink" title="特殊 IP 地址"></a>特殊 IP 地址</h3><div class="table-overflow"><table><thead><tr><th align="left">网络号</th><th align="left">主机号</th><th align="left">作为源地址</th><th align="left">作为目的地址</th><th align="left">用途</th></tr></thead><tbody><tr><td align="left">全 0</td><td align="left">全 0</td><td align="left">可以</td><td align="left">不可以</td><td align="left">表示网络范围内的主机 , 路由表中用于表示默认路由(表示整个 Internet 网络)</td></tr><tr><td align="left">全 0</td><td align="left">特定值</td><td align="left">可以</td><td align="left">不可以</td><td align="left">表示本网络范围内的特定主机</td></tr><tr><td align="left">全 1</td><td align="left">全 1</td><td align="left">不可以</td><td align="left">可以</td><td align="left">本网广播地址(路由器不转发广播地址)</td></tr><tr><td align="left">特定值</td><td align="left">全 0</td><td align="left">不可以</td><td align="left">不可以</td><td align="left">表示一个网段</td></tr><tr><td align="left">特定值</td><td align="left">全 1</td><td align="left">不可以</td><td align="left">可以</td><td align="left">直接广播地址, 对特定网络所有主机进行广播</td></tr><tr><td align="left">127</td><td align="left">任何(非全 0/1)</td><td align="left">可以</td><td align="left">可以</td><td align="left">本地回环地址</td></tr></tbody></table></div><p><span id="总结对比"></span></p><h3 id="总结对比"><a href="#总结对比" class="headerlink" title="总结对比"></a>总结对比</h3><div class="table-overflow"><table><thead><tr><th align="left">网络类别</th><th align="left">A</th><th align="left">B</th><th align="left">C</th></tr></thead><tbody><tr><td align="left">特征位</td><td align="left">0</td><td align="left">10</td><td align="left">110</td></tr><tr><td align="left">网络号长度</td><td align="left">8bit</td><td align="left">16bit</td><td align="left">24bit</td></tr><tr><td align="left">主机号长度</td><td align="left">24bit</td><td align="left">16bit</td><td align="left">8bit</td></tr><tr><td align="left">最大网络数</td><td align="left">126 ($2^7 – 2$)</td><td align="left">16,383 ($2^{14}-1$)</td><td align="left">2,097,151 ($2^{21}-1$)</td></tr><tr><td align="left">第一个可用的网络号</td><td align="left">1</td><td align="left">128.0</td><td align="left">192.0.0</td></tr><tr><td align="left">最后一个可用的网络号</td><td align="left">126</td><td align="left">191.255</td><td align="left">223.255.255</td></tr><tr><td align="left">每个网络的最大主机数</td><td align="left">16777214($2^{24}-2$)</td><td align="left">65534($2^{16}-2$)</td><td align="left">254($2^8-2$)</td></tr></tbody></table></div><blockquote><p>A 类中不可用的网络数有全 0 和全 1(回环地址)</p></blockquote><p><span id="网络地址转换NAT"></span></p><h1 id="网络地址转换-NAT"><a href="#网络地址转换-NAT" class="headerlink" title="网络地址转换 NAT"></a>网络地址转换 NAT</h1><p>网络地址转换 NAT 是指: 在<em>专用网</em>连接到<em>因特网</em>的路由器上安装 NAT 软件。装有 NAT 软件的路由器叫做 <strong>NAT 路由器</strong>，它至少有一个有效的<strong>外部全球 IP 地址</strong></p><ul><li><p>功能<br>让内网用户能访问外网</p></li><li><p>NAT 转换表<br>记录 WAN 端 IP 地址和端口对应的 LAN 端 IP 地址和端口<br>内网主机发出去的数据转换成转换表中的 IP 和端口, 路由器接收到信息后, 根据 NAT 转换表将数据发送给对应的主机</p><blockquote><p>WAN 端是外网, LAN 端是内网</p></blockquote></li><li><p>转换过程</p><ol><li>内部主机 X 用本地地址 IPX 和因特网上主机 Y 通信所发送的数据报必须经过 NAT 路由器</li><li>NAT 路由器将数据报的源地址 IPX 转换成全球地址 IPG,但目的地址 IPY 保持不变,然后发送到因特网</li><li>NAT 路由器收到主机 Y 发回的数据报时,知道数据报中的源地址是 IPY 而目的地址是 IPG</li><li>根据 NAT 转换表,NAT 路由器将目的地址 IPG 转换为 IPX,转发给最终的内部主机 X</li></ol></li></ul><p><span id="子网划分,子网掩码,CIDR"></span></p><h1 id="子网划分-子网掩码-CIDR"><a href="#子网划分-子网掩码-CIDR" class="headerlink" title="子网划分,子网掩码,CIDR"></a>子网划分,子网掩码,CIDR</h1><p><span id="子网划分"></span></p><h2 id="子网划分"><a href="#子网划分" class="headerlink" title="子网划分"></a>子网划分</h2><blockquote><p>因分类的 IP 地址有如下缺点</p><ol><li>IP 地址空间的利用率有时很低</li><li>两级 IP 地址不够灵活</li></ol></blockquote><p>划分子网后, 对外仍表现为一个网络<br>即本单位外的网络不知道本单位内子网的划分</p><p><strong>注意, 子网划分中主机号不能全 0 全 1, 子网号要分情况判断能否全 0 全 1</strong></p><ul><li><p>原理<br>将主机号中划分出部分作为子网号</p><div align="center"><p><img src="/network-network5/ipadd.png" alt="IP地址划分后的结构"></p></div></li></ul><p><span id="子网掩码"></span></p><h2 id="子网掩码"><a href="#子网掩码" class="headerlink" title="子网掩码"></a>子网掩码</h2><p>网络号(包括子网号 )全 1, 主机号全 0</p><p><span id="路由器分组转发算法"></span></p><h3 id="路由器分组转发算法"><a href="#路由器分组转发算法" class="headerlink" title="路由器分组转发算法"></a>路由器分组转发算法</h3><blockquote><p>路由表中包含目的地址,该目的地址的子网掩码,及下一跳地址</p></blockquote><ol><li>提取目的 IP 地址</li><li>判断是否可以直接交付<br>即 IP 地址是否在直连的网络上</li><li>特定主机路由</li><li>检测路由器路由表中有无路径<br>将目的地址与子网掩码相与, 若与路由表中的目的地址相同, 则网下一跳地址发送<br>无路径则到第 5 步</li><li>使用默认路由<br>0.0.0.0</li><li>丢弃,报告转发分组出错</li></ol><p><span id="无分类编址CIDR"></span></p><h2 id="无分类编址-CIDR"><a href="#无分类编址-CIDR" class="headerlink" title="无分类编址 CIDR"></a>无分类编址 CIDR</h2><p>组成格式={网络前缀:主机号}<br>即在 IP 地址后加上 “/“,后面跟上网络前缀所占的位数(对应三级编址中子网掩码中 1 的个数),如”220.78.162/24”</p><ul><li><p>优点</p><ol><li><p>消除传统 A,B,C 类地址以及划分子网的概念</p></li><li><p>融合子网地址与子网掩码, 分别子网划分</p></li></ol></li><li><p>地址掩码<br>与子网掩码相同</p></li><li><p>地址块<br>网络前缀相同的称为<strong>CIDR 地址块</strong></p></li></ul><p><span id="路由聚合"></span></p><h3 id="路由聚合"><a href="#路由聚合" class="headerlink" title="路由聚合"></a>路由聚合</h3><blockquote><p>也叫构成超网</p></blockquote><p>将多个 IP 地址聚合成一个地址块</p><ul><li><p>好处<br>可以更加有效的分配 IPv4 的地址空间,可根据客户的需要分配适当大小的 CIDR 地址快</p></li><li><p>方法<br>多个 IP 地址从第一位比较起,一直到最后一个不同的截止,将相同的这部分作为网络前缀</p><div align="center"><p><img src="/network-network5/luyoujuhe.png" alt="路由聚合"></p></div></li></ul><p><span id="最长前缀匹配"></span></p><h3 id="最长前缀匹配"><a href="#最长前缀匹配" class="headerlink" title="最长前缀匹配"></a>最长前缀匹配</h3><p>使用 CIDR 时, 查找路由表可能得到几个匹配结果, 选择具有最长网络前缀的路由<br>前缀越长, 地址块越小, 路由越具体</p><p><span id="ARP协议"></span></p><h1 id="ARP-协议"><a href="#ARP-协议" class="headerlink" title="ARP 协议"></a>ARP 协议</h1><blockquote><p>因为在实际网络的链路上传送数据帧时, 必须使用 MAC 地址<br>因此通过 ARP 协议来获得下一跳 MAC 地址</p></blockquote><p>用于 IP 地址与 MAC 地址(硬件地址)的转换</p><ul><li>ARP 高速缓存<br>IP 地址与 MAC 地址的映射</li></ul><p><span id="ARP协议原理"></span></p><h2 id="ARP-协议原理"><a href="#ARP-协议原理" class="headerlink" title="ARP 协议原理"></a>ARP 协议原理</h2><ul><li>若有对应表则写入 MAC 帧</li><li>若没有则用目的 MAC 地址为<code>全1</code>的帧封装并<strong>广播 ARP 请求分组</strong><br><em>同一局域网</em>中所有主机都能收到该请求<br>目的主机收到请求后向源主机<strong>单播 ARP 响应分组</strong><br>源主机收到后将此映射写入 ARP 缓存</li></ul><p><span id="ARP使用情况"></span></p><h2 id="ARP-使用情况"><a href="#ARP-使用情况" class="headerlink" title="ARP 使用情况"></a>ARP 使用情况</h2><div class="table-overflow"><table><thead><tr><th align="left">情况</th><th align="left">方法</th></tr></thead><tbody><tr><td align="left">主机 A 发给<code>本网络</code>的主机 B</td><td align="left">用 ARP 找到主机 B 的 MAC 地址</td></tr><tr><td align="left">主机 A 发给<code>另一网络</code>的主机 B</td><td align="left">用 ARP 找到本网络上一个路由器(网关)的 MAC 地址</td></tr><tr><td align="left">路由器发给<code>本网络</code>的主机 A</td><td align="left">用 ARP 找到主机 A 的 MAC 地址</td></tr><tr><td align="left">路由器发给<code>另一网络</code>的主机 B</td><td align="left">用 ARP 找到本网络上一个路由器(网关)的 MAC 地址</td></tr></tbody></table></div><blockquote><p>源 IP 与目的 IP 在同一局域网内(在一个网段内)</p><blockquote><ul><li>广播 ARP 请求(其中目的 MAC 地址为全 1, 表示广播的分组)</li><li>单播响应(只有与目的 IP 地址相同的主机才会响应该请求, 回复源 IP 自身的 MAC 地址)</li></ul></blockquote></blockquote><blockquote><p>源 IP 与目的 IP 不在同一局域网内(不在同一网段)</p><blockquote><ol><li>发送端查询默认网关(与其他网段相连的路由器的内网接口)的 MAC 地址<br>广播 ARP 请求, 网关回复 MAC 地址</li><li>将要发送的分组的目的 MAC 地址设为默认网关的 MAC 地址, 目的 IP 不变</li><li>路由器收到后, 将数据转发出去<br>其中源 MAC 地址改成该路由器出口(与外界相连的接口)MAC 地址, 目的 MAC 修改为下一跳的 MAC 地址(若不知道,则路由器作为发送设备, 回到步骤 1, 直到将数据发送到目的 IP)</li></ol></blockquote></blockquote><p><span id="DHCP协议"></span></p><h1 id="DHCP-协议"><a href="#DHCP-协议" class="headerlink" title="DHCP 协议"></a>DHCP 协议</h1><ul><li><p>DHCP 时<strong>应用层</strong>协议, 使用<strong>客户/服务器</strong>方式<br>客户端和服务端通过<strong>广播</strong>方式进行交互(基于<strong>UDP</strong>)</p></li><li><p>提供<strong>即插即用</strong>联网机制<br>主机重服务器动态获取 IP 地址,子网掩码,默认网关,DNS 服务器名称与 IP 地址<br>允许<strong>地址重用</strong>, 支持<strong>移动用户加入网络</strong>,支持<strong>再用地址续租</strong></p></li></ul><p><span id="工作流程"></span></p><h2 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h2><ol><li>主机广播 DHCP 发现报文<br>通过广播找到网络服务器</li><li>DHCP 服务器广播 DHCP 提供报文<br>服务器拟分配给主机一个 IP 地址<blockquote><p>同一时间可能会有多个服务器响应主机的发现报文, 主机先收到哪一个就使用哪一个服务器</p></blockquote></li><li>主机广播 DHCP 请求报文<br>向服务器确认使用拟定的 IP 地址<blockquote><p>用广播也可以通知第 2 步中其他发来报文的主机收回拟定的 IP</p></blockquote></li><li>DHCP 服务器广播 DHCP 确认报文<br>正式将 IP 地址分配给主机</li></ol><p><span id="ICMP协议"></span></p><h1 id="ICMP-协议"><a href="#ICMP-协议" class="headerlink" title="ICMP 协议"></a>ICMP 协议</h1><blockquote><p>ICMP 支持主机或路由器</p></blockquote><ul><li>作用<br>差错或异常报告<br>网络探询</li></ul><p><span id="ICMP报文格式"></span></p><h2 id="ICMP-报文格式"><a href="#ICMP-报文格式" class="headerlink" title="ICMP 报文格式"></a>ICMP 报文格式</h2><div align="center"><p><img src="/network-network5/icmpstruct.jpg" alt="ICMP报文格式"></p></div><p><span id="ICMP报文类型"></span></p><h2 id="ICMP-报文类型"><a href="#ICMP-报文类型" class="headerlink" title="ICMP 报文类型"></a>ICMP 报文类型</h2><p><span id="ICMP差错报告报文"></span></p><ul><li><h3 id="ICMP-差错报告报文"><a href="#ICMP-差错报告报文" class="headerlink" title="ICMP 差错报告报文"></a>ICMP 差错报告报文</h3><ol><li>终点不可达<br>(无法交付)<br>路由器或主机不能交付数据时, 向源点发送<u>终点不可达</u></li><li>源点抑制<br>(拥塞丢失数据)<br>路由器或主机由于拥塞而丢弃数据报时, 向源点发送<u>源点抑制报文</u>, 使源点把数据报发送速率放慢</li><li>时间超时<br>路由器收到生存时间 TTL=0 的数据报时, 丢弃该数据报,并向源点发送<u>时间超过报文</u><br>当终点在预先规定时间内不能收到一个数据报的全部数据报片时, 把已收到的数据报片丢弃, 并向源点发送<u>时间超过报文</u></li><li>参数问题<br>路由器或主机收到的数据报的首部中字段不正确时, 丢弃该数据报,并向源点发送<u>参数问题报文</u></li><li>改变路由(重定向)<br>路由器把<u>改变路由报文</u>发送给主机, 让主机知道更好的路由路径</li></ol></li></ul><div align="center"><p><img src="/network-network5/icmperror.jpg" alt="ICMP差错报告报文格式"></p></div><blockquote><p>以下情况不发送 ICMP 差错报文</p><blockquote><ol><li>对 ICMP 差错报告报文不在发送 ICMP 差错报告报文</li><li>对第一个分片数据报片的所有后续数据报片都不发送 ICMP 差错报告报文</li><li>对具有组播地址的数据报不发送 ICMP 差错报告报文</li><li>对具有特殊地址(如:0.0.0.0 127.0.0.0)的数据报不发送 ICMP 差错报告报文</li></ol></blockquote></blockquote><p><span id="ICMP询问报文"></span></p><ul><li><h3 id="ICMP-询问报文"><a href="#ICMP-询问报文" class="headerlink" title="ICMP 询问报文"></a>ICMP 询问报文</h3><ol><li>回送请求和回答报文<br>主机或路由器向特定目的主机发出的询问, 收到此报文的主机必须给源主机或路由器发送 ICMP 回送回答报文(Ping)<blockquote><p>测试目的站是否可达并了解其相关状态</p></blockquote></li><li>时间戳请求和回答报文<br>请某个主机或路由器回答当前日期和时间<blockquote><p>用来进行时钟同步和测量时间</p></blockquote></li><li>掩码地址请求和回答报文</li><li>路由器询问和通告报文</li></ol></li></ul><p><span id="ICMP的应用"></span></p><h2 id="ICMP-的应用"><a href="#ICMP-的应用" class="headerlink" title="ICMP 的应用"></a>ICMP 的应用</h2><ul><li>Ping<br>测试两个主机之间的连通性<blockquote><p>使用 ICMP 回送请求和回答报文</p></blockquote></li><li>Traceroute<br>跟踪一个分组从源点到终点的路径<blockquote><p>使用了 ICMP 时间超过差错报告报文</p></blockquote></li></ul><p><span id="IPv"></span></p><h1 id="IPv6"><a href="#IPv6" class="headerlink" title="IPv6"></a>IPv6</h1><blockquote><p>32 位 IPv4 地址空间已用完</p></blockquote><ul><li>目的<ol><li>从根本上解决地址耗尽问题</li><li>改进首部格式<br>实现快速处理和转发数据报功能<br>支持 QoS</li></ol></li></ul><p><span id="IPv数据报格式"></span></p><h2 id="IPv6-数据报格式"><a href="#IPv6-数据报格式" class="headerlink" title="IPv6 数据报格式"></a>IPv6 数据报格式</h2><div align="center"><p><img src="/network-network5/ipv6.jpg" alt="IPv6数据报格式"></p></div><div align="center"><p><img src="/network-network5/ipv6.jpg" alt="IPv6首部格式"></p></div><ul><li>版本<br>协议版本, 总是 6</li><li>优先级<br>数据报的类别和优先级</li><li>流标签<br>所有属于同一个流的数据报拥有相同的流标签<blockquote><p>流是互联网上从特定源点到特定终点的一系列数据</p></blockquote></li><li>有效载荷长度<br>指明有效载荷部分+数据部分的长度</li><li>下一个首部<br>标识下一个扩展首部或上层协议首部的位置</li><li>跳数限制<br>生存时间</li><li>源地址</li><li>目的地址</li></ul><p><span id="对比IPv"></span></p><h2 id="对比-IPv4"><a href="#对比-IPv4" class="headerlink" title="对比 IPv4"></a>对比 IPv4</h2><blockquote><p>前 6 个比较重要</p></blockquote><ol><li>IPv6 地址长度扩大到 128 位</li><li>IPv6 移除了校验和<br>减少了每跳的处理时间</li><li>IPv6 移除了 IPv4 的可选字段, 变成了扩展首部<br>比较灵活, 路由器一般不检测扩展首部<br>提高了路由器的处理效率</li><li>IPv6 支持即插即用<br>自动配置, 不需要 DHCP</li><li>IPv6 首部的长度必须是<code>8B</code>的整数倍, IPv4 首部是<code>4B</code>的整数数</li><li><strong>IPv6 只能在主机处分片</strong>, IPv4 可以在路由器和主机处分片</li><li>IPv6 使用 ICMPv6,附加报文类型–分组过大</li><li>IPv6 支持资源的预分配, 支持实时视像等要求, 保证一定的带宽和时延的应用</li><li>IPv6 取消了协议字段, 改成下一个首部字段</li><li>IPv6 取消了总长度字段, 改用有效载荷长度字段</li><li>IPv6 取消了服务类型字段</li></ol><p><span id="IPv地址形式"></span></p><h2 id="IPv6-地址形式"><a href="#IPv6-地址形式" class="headerlink" title="IPv6 地址形式"></a>IPv6 地址形式</h2><div align="center"><p><img src="/network-network5/ipv6addr.jpg" alt="IPv6地址形式"></p></div><p><span id="基本地址类型"></span></p><h2 id="基本地址类型"><a href="#基本地址类型" class="headerlink" title="基本地址类型"></a>基本地址类型</h2><ul><li>单播<br>一对一通信<br>可做源地址和目的地址</li><li>多播<br>一对多通信<br>只能作为目的地址</li><li>任播<br>一对多的一个通信<br>只可做目的地址</li></ul><p><span id="IPv与Ipv的兼容"></span></p><h2 id="IPv6-与-Ipv4-的兼容"><a href="#IPv6-与-Ipv4-的兼容" class="headerlink" title="IPv6 与 Ipv4 的兼容"></a>IPv6 与 Ipv4 的兼容</h2><ul><li><p>双栈计算<br>双协议栈技术就是指在一台设备上<strong>同时启用 IPv4 协议栈和 IPv6 协议栈</strong>. 这样的话, 这台设备既能和 IPv4 网络通信, 又能和 IPv6 网络通信<br>如果这台设备是一个<strong>路由器</strong>, 那么这台路由器的不同接口上, 分别配置了 IP4 地址和 IPv6 地址, 并很可能分别连接了 IPv4 网络和 IPv6 网络<br>如果这台设备是一个<strong>计算机</strong>, 那么它将同时拥有 IPv4 地址和 IPv6 地址, 并具备同时处理这两个协议地址的功能</p></li><li><p>隧道计算<br>通过使用互联网络的基础设施在网络之间传递数据的方式<br>使用隧道传递的数据(或负载)可以是不同协议的数据帧或包<br>隧道协议将其它协议的数据帧或包<strong>重新封装</strong>然后通过隧道发送</p></li></ul></div><div class="article-licensing box"><div class="licensing-title"><p>计算机网络——网络层</p><p><a href="https://blog.cshf.xyz/network-network5/">https://blog.cshf.xyz/network-network5/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>CSHF</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-07-20</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-08-17</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/NetWork/">NetWork</a></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><div class="social-share"></div><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/alipay.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/wechat.png" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/network-network6/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">计算机网络——传输层</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/network-network4/"><span class="level-item">计算机网络——数据链路层</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><div class="content" id="waline-thread"></div><script src="https://cdn.jsdelivr.net/npm/@waline/client@1.3.1/dist/Waline.min.js"></script><script>Waline({el:"#waline-thread",serverURL:"https://comment-33ock0yem-smallpigboy.vercel.app/",lang:"zh-CN",visitor:!1,emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],dark:"auto",meta:["nick","mail","link"],requiredMeta:[],login:"enable",avatar:"mp",pageSize:10,avatarCDN:"https://sdn.geekzu.org/avatar/",avatarForce:!1,highlight:!0,mathTagSupport:!1,copyright:!0,locale:{placeholder:"Comment here..."}})</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#目录"><span class="level-left"><span class="level-item">目录</span></span></a></li><li><a class="level is-mobile" href="#网络层概述"><span class="level-left"><span class="level-item">网络层概述</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#网络层的协议"><span class="level-left"><span class="level-item">网络层的协议</span></span></a></li><li><a class="level is-mobile" href="#功能"><span class="level-left"><span class="level-item">功能</span></span></a></li></ul></li><li><a class="level is-mobile" href="#IP-协议"><span class="level-left"><span class="level-item">IP 协议</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#IP-数据报格式"><span class="level-left"><span class="level-item">IP 数据报格式</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#组成格式"><span class="level-left"><span class="level-item">组成格式</span></span></a></li><li><a class="level is-mobile" href="#IP-首部格式"><span class="level-left"><span class="level-item">IP 首部格式</span></span></a></li></ul></li><li><a class="level is-mobile" href="#数据报分片"><span class="level-left"><span class="level-item">数据报分片</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#偏移量的计算"><span class="level-left"><span class="level-item">偏移量的计算</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#IPv4"><span class="level-left"><span class="level-item">IPv4</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#分类-IP-地址"><span class="level-left"><span class="level-item">分类 IP 地址</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#A-类地址"><span class="level-left"><span class="level-item">A 类地址</span></span></a></li><li><a class="level is-mobile" href="#B-类地址"><span class="level-left"><span class="level-item">B 类地址</span></span></a></li><li><a class="level is-mobile" href="#C-类地址"><span class="level-left"><span class="level-item">C 类地址</span></span></a></li><li><a class="level is-mobile" href="#D-类地址"><span class="level-left"><span class="level-item">D 类地址</span></span></a></li><li><a class="level is-mobile" href="#E-类地址"><span class="level-left"><span class="level-item">E 类地址:</span></span></a></li><li><a class="level is-mobile" href="#特殊-IP-地址"><span class="level-left"><span class="level-item">特殊 IP 地址</span></span></a></li><li><a class="level is-mobile" href="#总结对比"><span class="level-left"><span class="level-item">总结对比</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#网络地址转换-NAT"><span class="level-left"><span class="level-item">网络地址转换 NAT</span></span></a></li><li><a class="level is-mobile" href="#子网划分-子网掩码-CIDR"><span class="level-left"><span class="level-item">子网划分,子网掩码,CIDR</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#子网划分"><span class="level-left"><span class="level-item">子网划分</span></span></a></li><li><a class="level is-mobile" href="#子网掩码"><span class="level-left"><span class="level-item">子网掩码</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#路由器分组转发算法"><span class="level-left"><span class="level-item">路由器分组转发算法</span></span></a></li></ul></li><li><a class="level is-mobile" href="#无分类编址-CIDR"><span class="level-left"><span class="level-item">无分类编址 CIDR</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#路由聚合"><span class="level-left"><span class="level-item">路由聚合</span></span></a></li><li><a class="level is-mobile" href="#最长前缀匹配"><span class="level-left"><span class="level-item">最长前缀匹配</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#ARP-协议"><span class="level-left"><span class="level-item">ARP 协议</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ARP-协议原理"><span class="level-left"><span class="level-item">ARP 协议原理</span></span></a></li><li><a class="level is-mobile" href="#ARP-使用情况"><span class="level-left"><span class="level-item">ARP 使用情况</span></span></a></li></ul></li><li><a class="level is-mobile" href="#DHCP-协议"><span class="level-left"><span class="level-item">DHCP 协议</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#工作流程"><span class="level-left"><span class="level-item">工作流程</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ICMP-协议"><span class="level-left"><span class="level-item">ICMP 协议</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ICMP-报文格式"><span class="level-left"><span class="level-item">ICMP 报文格式</span></span></a></li><li><a class="level is-mobile" href="#ICMP-报文类型"><span class="level-left"><span class="level-item">ICMP 报文类型</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ICMP-差错报告报文"><span class="level-left"><span class="level-item">ICMP 差错报告报文</span></span></a></li><li><a class="level is-mobile" href="#ICMP-询问报文"><span class="level-left"><span class="level-item">ICMP 询问报文</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ICMP-的应用"><span class="level-left"><span class="level-item">ICMP 的应用</span></span></a></li></ul></li><li><a class="level is-mobile" href="#IPv6"><span class="level-left"><span class="level-item">IPv6</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#IPv6-数据报格式"><span class="level-left"><span class="level-item">IPv6 数据报格式</span></span></a></li><li><a class="level is-mobile" href="#对比-IPv4"><span class="level-left"><span class="level-item">对比 IPv4</span></span></a></li><li><a class="level is-mobile" href="#IPv6-地址形式"><span class="level-left"><span class="level-item">IPv6 地址形式</span></span></a></li><li><a class="level is-mobile" href="#基本地址类型"><span class="level-left"><span class="level-item">基本地址类型</span></span></a></li><li><a class="level is-mobile" href="#IPv6-与-Ipv4-的兼容"><span class="level-left"><span class="level-item">IPv6 与 Ipv4 的兼容</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list>li>a.is-active+.menu-list{display:block}#toc .menu-list>li>a+.menu-list{display:none}</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/App/"><span class="tag">App</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/C/"><span class="tag">C</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ClientIP/"><span class="tag">ClientIP</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Computer-Organization-Principles/"><span class="tag">Computer Organization Principles</span><span class="tag">8</span></a></div><div class="control"><a class="tags has-addons" href="/tags/DataStructure/"><span class="tag">DataStructure</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/InformationLeakage/"><span class="tag">InformationLeakage</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Kivy/"><span class="tag">Kivy</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/LKM/"><span class="tag">LKM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/NetWork/"><span class="tag">NetWork</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/PE/"><span class="tag">PE</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/SQL/"><span class="tag">SQL</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/WEB/"><span class="tag">WEB</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Windows/"><span class="tag">Windows</span><span class="tag">1</span></a></div></div></div></div></div><div class="column-right-shadow is-hidden-widescreen is-sticky"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time datetime="2021-08-09T11:09:57.000Z">2021-08-09</time></p><p class="title"><a href="/COP-COP-7/">计算机组成原理——输入输出系统</a></p><p class="categories"><a href="/categories/Note/">Note</a> / <a href="/categories/Note/Computer-Organization-Principles/">Computer Organization Principles</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-08-07T11:28:07.000Z">2021-08-07</time></p><p class="title"><a href="/COP-COP-6/">计算机组成原理——总线</a></p><p class="categories"><a href="/categories/Note/">Note</a> / <a href="/categories/Note/Computer-Organization-Principles/">Computer Organization Principles</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-07-23T12:18:02.000Z">2021-07-23</time></p><p class="title"><a href="/network-network7/">计算机网络——应用层</a></p><p class="categories"><a href="/categories/Note/">Note</a> / <a href="/categories/Note/NetWork/">NetWork</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-07-22T11:09:54.000Z">2021-07-22</time></p><p class="title"><a href="/network-network6/">计算机网络——传输层</a></p><p class="categories"><a href="/categories/Note/">Note</a> / <a href="/categories/Note/NetWork/">NetWork</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time datetime="2021-07-20T08:36:33.000Z">2021-07-20</time></p><p class="title"><a href="/network-network5/">计算机网络——网络层</a></p><p class="categories"><a href="/categories/Note/">Note</a> / <a href="/categories/Note/NetWork/">NetWork</a></p></div></article></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/CSHF_LOGO.png" alt="CSHF" height="28"></a><p class="is-size-7"><span>&copy; 2021 CSHF</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN")</script><script>var IcarusThemeSettings={article:{highlight:{clipboard:!0,fold:"unfolded"}}}</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load",()=>{"function"==typeof $.fn.lightGallery&&$(".article").lightGallery({selector:".gallery-item"}),"function"==typeof $.fn.justifiedGallery&&($(".justified-gallery > p > .gallery-item").length&&$(".justified-gallery > p > .gallery-item").unwrap(),$(".justified-gallery").justifiedGallery())})</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener("DOMContentLoaded",function(){loadInsight({contentUrl:"/content.json"},{hint:"想要查找什么...",untitled:"(无标题)",posts:"文章",pages:"页面",categories:"分类",tags:"标签"})})</script></body></html>